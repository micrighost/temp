# NR7反轉策略

## 簡介
NR7突破策略是一個基於Narrow Range 7 (NR7) 指標的自動交易策略，旨在捕捉市場的突破機會。當市場經歷一段壓縮後，該策略會根據過去7天的價格範圍來判斷是否出現突破，並在價格突破時進行交易。

## 版本
- **版本**: 1.00

## 安裝步驟
1. 將 `NR7反轉策略.mq5` 文件放入 MetaTrader 5 的 `Experts` 目錄中。
2. 打開 MetaTrader 5，並在導航欄中找到「專家顧問」。
3. 右鍵點擊「專家顧問」，選擇「重新加載」以加載新的策略。
4. 將策略拖放到圖表上，並根據需要進行設置。

## 使用說明
- **交易手數**: 可以通過 `Lot` 參數設置交易手數，默認為 `0.01`。
- **啟用NR7判斷**: 可以通過 `UseNR7` 參數選擇是否啟用NR7判斷，默認為 `true`。

### 策略邏輯
1. 判斷當前K棒是否為NR7燭台（即當天的價格範圍小於過去7天的所有K棒）。
2. 如果是NR7燭台，則檢查當前價格是否突破了前一根K棒的高點或低點。
3. 根據突破方向進行交易：
   - **做多**: 當現賣價低於前一根K棒的低點時，進行買入操作，並設置停損和停利。
   - **做空**: 當現買價高於前一根K棒的高點時，進行賣出操作，並設置停損和停利。

## 函式說明
- `IsNewBar()`: 檢查是否有新的K棒出現。
- `GetRange(int index)`: 計算指定K棒的價格區間範圍。
- `IsNR7(int current_bar)`: 判斷指定K棒是否為NR7燭台。
- `HasPosition()`: 檢查是否已有持倉。
- `GetBarPrice(int index, double &high, double &low, double &close, double &next_open)`: 取得指定K棒的高、低、收盤和下一根K棒的開盤價格。
- `CheckBreakoutAndTrade()`: 檢查NR7突破並執行交易。
- `OnInit()`: 初始化函式，EA啟動時執行。
- `OnDeinit(int reason)`: 程式結束函式，EA停用時執行。
- `OnTick()`: 主執行函式，每次收到新Tick觸發計算。